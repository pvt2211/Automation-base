{"$type":"GPMAutomateEditor.Models.Editor, GPMAutomateEditor.Models","before_init":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"fileExcelPath","delay":"0,0","id":"af8575c4-6ad9-4b92-9c1d-e7b72cf38370","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"abc\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Excel file path"},{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"sheetSaveData","delay":"0,0","id":"b375df9c-c73f-4e6f-a1e2-62a51e18a6c4","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"1\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"index sheet lưu thông tin trạng thái X"}],"expanded":false,"id":"0c34da1c-99e6-4dae-b913-c18305c5ae91","display_text":null,"raw_input":"[]","comment":"Setup các sheet index excel"},{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"columnUsernameX","delay":"0,0","id":"aacc3c24-04f9-4e11-b90f-b118c946d8ce","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"I\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Cột lưu thông tin tài khoản X"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"columnPasswordX","delay":"0,0","id":"5fc8f1a3-49f5-47e2-9709-2d4de9474090","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"J\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Cột lưu thông tin mật khẩu X"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"columnCode2FaX","delay":"0,0","id":"24209a00-de87-4f71-9a84-683847cc4e90","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"K\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Cột lưu thông tin mã 2fa X"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"columnEmailX","delay":"0,0","id":"c2df006d-b1d6-495a-942f-c3c59a1d3e97","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"L\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Cột lưu thông tin email X"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"columnPasswordEmailX","delay":"0,0","id":"1d3f4474-c748-4e27-a2fa-99494061a159","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"M\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Cột lưu thông tin mật khẩu email X"}],"expanded":false,"id":"892ff93f-0930-4311-968a-548f996a981c","display_text":null,"raw_input":"[]","comment":"Setup các cột lưu thông tin tài khoản X"},{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"columnStatusLoginX","delay":"0,0","id":"dba9fdc4-fbf0-4352-aace-1338489b2f82","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"AA\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Cột đã đăng nhập xong (Sheet index 1)"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"columnStatusX","delay":"0,0","id":"2f14b251-6102-49cf-a465-4bb87a33fc21","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"M\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Cột ghi tình trạng tài khoản X (Sheet index 1)"}],"expanded":false,"id":"d1d418e3-f8c7-44c7-8ba4-5e5df611d4e5","display_text":null,"raw_input":"[]","comment":"Setup các cột ghi chú thông tin trạng thái X (lưu ở sheet 1)"}],"expanded":false,"id":"51dc20ac-ad46-4666-807b-e41681a779a3","display_text":null,"raw_input":null,"comment":"Before browser opened"},"main_logic":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":29,"element_xpath":null,"output_variable_name":"resToken","delay":"200,500","id":"88bc5f3e-07fd-4be7-bdfa-3e84e76a5cf9","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"https://api.mail.tm/token\"},{\"Key\":\"METHOD\",\"Value\":\"POST\"},{\"Key\":\"HEADER\",\"Value\":\"\"},{\"Key\":\"DATA\",\"Value\":\"{\\\"address\\\": \\\"$inputExcel[$columnEmailX]\\\", \\\"password\\\": \\\"$inputExcel[$columnPasswordEmailX]\\\"}\"},{\"Key\":\"USE_PROFILE_PROXY\",\"Value\":\"True\"}]","comment":"Gọi api lấy token authorization"},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":22,"element_xpath":null,"output_variable_name":null,"delay":"100,100","id":"5a190ef5-cdae-428a-9c73-e79b5364152d","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"$fileExcelPath\"},{\"Key\":\"SHEET_ID\",\"Value\":\"$sheetSaveData\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"$columnStatusX\"},{\"Key\":\"ROW_INDEX\",\"Value\":\"$inputExcel[Z]\"},{\"Key\":\"DATA\",\"Value\":\"Email hoặc password tài khoản X không đúng\"}]","comment":"Email hoặc password tài khoản X không đúng"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":76,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"3ed5fc14-a373-4bd5-9244-e278fd937e9f","display_text":null,"raw_input":"[]","comment":"Dừng lại do không đọc được mail tài khoản X"}],"expanded":false,"id":"de51b6b4-0c4b-4ae0-b6ea-e311dc79ba36","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"!$resToken contains token\"}]","comment":"check nếu không lấy được token"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":10,"element_xpath":null,"output_variable_name":"token","delay":"200,200","id":"5fea64d8-3ba5-4705-baf3-a3dc850c84fc","display_text":null,"raw_input":"[{\"Key\":\"JSON\",\"Value\":\"$resToken\"},{\"Key\":\"NODES\",\"Value\":\"token\"}]","comment":"Lấy token từ response"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":29,"element_xpath":null,"output_variable_name":"resMessages","delay":"200,500","id":"33703657-3421-4123-aa02-edfe93bceb9a","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"https://api.mail.tm/messages\"},{\"Key\":\"METHOD\",\"Value\":\"GET\"},{\"Key\":\"HEADER\",\"Value\":\"Authorization: Bearer $token\"},{\"Key\":\"DATA\",\"Value\":\"\"},{\"Key\":\"USE_PROFILE_PROXY\",\"Value\":\"True\"}]","comment":"Gọi API lấy danh sách message"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":10,"element_xpath":null,"output_variable_name":"arrMessages","delay":"100,100","id":"88bee6ab-de1f-430c-951c-ac8b167a04c3","display_text":null,"raw_input":"[{\"Key\":\"JSON\",\"Value\":\"$resMessages\"},{\"Key\":\"NODES\",\"Value\":\"hydra:member\"}]","comment":"Lấy mảng messages"},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"0,0","id":"24cf00f3-509a-476c-a096-0eb21d403f4e","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"0\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"False\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Trả về code mail tm = 0"}],"expanded":true,"id":"93b8825f-4549-4123-851c-95eb0c329327","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"$arrMessages = []\"}]","comment":"Check nếu chưa có message"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":68,"element_xpath":null,"output_variable_name":"idMailTm","delay":"0,0","id":"c2daf340-c5d5-4dee-90bb-e369a25696f4","display_text":null,"raw_input":"[{\"Key\":\"FILE_OR_CODE\",\"Value\":\"function findNewest(arrMail) { if (!Array.isArray(arrMail) || arrMail.length === 0) { return null; } return arrMail.reduce((newest, mail) => { const newestDate = new Date(newest.createdAt); const currentDate = new Date(mail.createdAt); return currentDate > newestDate ? mail : newest; }); } const arrMessages = $arrMessages; const arrUnseen = arrMessages.filter((temp) => { return temp.from.address == \\\"verify@x.com\\\" && temp.seen == false; }); const newestMail = findNewest(arrUnseen); return (newestMail? newestMail.id : null);\"}]","comment":"Lấy id mail mới nhất của X"},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"0,0","id":"400c0ca5-bf39-42e0-8720-aaa768acc80f","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"0\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"False\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Trả về code mail tm = 0 nếu không lấy được id"}],"expanded":true,"id":"b09ed91f-9f35-4581-8bfc-acaacffb4a4b","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"$idMailTm == null\"}]","comment":"Trả về code mail tm = 0 nếu không lấy được id"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":29,"element_xpath":null,"output_variable_name":"resMsg","delay":"200,500","id":"0599ce69-4715-4e8e-87c5-d0a02d11a079","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"https://api.mail.tm/messages/$idMailTm\"},{\"Key\":\"METHOD\",\"Value\":\"GET\"},{\"Key\":\"HEADER\",\"Value\":\"Authorization: Bearer $token\"},{\"Key\":\"DATA\",\"Value\":\"\"},{\"Key\":\"USE_PROFILE_PROXY\",\"Value\":\"True\"}]","comment":"Gọi API lấy thông tin chi tiết mail"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":10,"element_xpath":null,"output_variable_name":"checkIdMsg","delay":"200,200","id":"a6c6c29b-5b94-4d29-9739-c1cb4ac17e4d","display_text":null,"raw_input":"[{\"Key\":\"JSON\",\"Value\":\"$resMsg\"},{\"Key\":\"NODES\",\"Value\":\"@id\"}]","comment":null},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"100,200","id":"21f54665-59c7-4a4b-820c-0113c755ac69","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"0\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"False\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Trả về code mail tm = 0"}],"expanded":true,"id":"d80f7dab-28de-4b6f-9caa-d93cb5b1f500","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"$checkIdMsg contains errors\"}]","comment":"Nếu có lỗi trả về code mail tm = 0"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":10,"element_xpath":null,"output_variable_name":"textMailTm","delay":"100,200","id":"aabbaacb-f878-4963-b7df-de50cee19d02","display_text":null,"raw_input":"[{\"Key\":\"JSON\",\"Value\":\"$resMsg\"},{\"Key\":\"NODES\",\"Value\":\"text\"}]","comment":"lấy full text mail tm"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":68,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"100,200","id":"981acc90-54c1-4c87-a038-6d5052cac205","display_text":null,"raw_input":"[{\"Key\":\"FILE_OR_CODE\",\"Value\":\"function findSixDigitNumbers(text) { if (typeof text !== \\\"string\\\") { return []; } const regex = /\\\\b\\\\d{6}\\\\b/g; const matches = text.match(regex); return matches || []; } const textMailTm = `$textMailTm`; const arrMatches = findSixDigitNumbers(textMailTm); return arrMatches.length ? arrMatches[0] : 0;\"}]","comment":"Lấy code mail TM"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"0,0","id":"3ec5fcc2-a793-482e-86f2-9c740e66bff6","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"$codeMailTm\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"False\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Set code mail tm"}],"expanded":true,"id":"fd4777f9-9c49-442a-9ada-f609bb717c0b","display_text":null,"raw_input":"[]","comment":"Trường hợp ko lỗi vào chi tiết mail lấy code"}],"expanded":true,"id":"d43e5a35-eb72-46a3-997b-51644383ca94","display_text":null,"raw_input":"[]","comment":"Lấy code từ id mail"}],"expanded":true,"id":"7c0bb354-8f44-4d7b-9cca-41fb8058f3e2","display_text":null,"raw_input":"[]","comment":"Đã có mail về"}],"expanded":false,"id":"e65438a9-6f84-4d94-9e21-3aef023c98ad","display_text":null,"raw_input":"[]","comment":"Trường hợp lấy được token"}],"expanded":false,"id":"81f33aed-eb4d-4582-b264-6b13bf5845c7","display_text":null,"raw_input":null,"comment":"Main logic"},"after_quit":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[],"expanded":false,"id":"647aecf3-4eb9-4c49-baf1-d38fadfb7c88","display_text":null,"raw_input":null,"comment":"After browser closed"}}