{"$type":"GPMAutomateEditor.Models.Editor, GPMAutomateEditor.Models","before_init":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"excelFilePath","delay":"0,0","id":"3419d9d2-11cf-4d42-b382-0bc61c23831a","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Excel file path\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Excel file path"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"sheetSaveData","delay":"0,0","id":"30944e88-aeb8-417e-90ae-57bf073aeb58","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"1\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"index sheet lưu thông tin trạng thái "},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"mailFromSource","delay":"0,0","id":"746bd89d-5b69-4084-a400-51ce4a81f190","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"account-security-noreply@accountprotection.microsoft.com\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập nguồn mà muốn đọc mail từ(Ví dụ verify@x.com)"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"columnMailTm","delay":"0,0","id":"d8f8871a-34d1-4a82-8dc6-3916bb26d2c6","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Y\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Cột ghi thông tin mail tm"}],"expanded":true,"id":"ec784904-891c-435f-8388-a3bd16b9ad29","display_text":null,"raw_input":null,"comment":"Before browser opened"},"main_logic":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":29,"element_xpath":null,"output_variable_name":"resToken","delay":"200,500","id":"19744252-1c14-45c0-a86a-4ddb40489820","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"https://api.mail.tm/token\"},{\"Key\":\"METHOD\",\"Value\":\"POST\"},{\"Key\":\"HEADER\",\"Value\":\"\"},{\"Key\":\"DATA\",\"Value\":\"{\\\"address\\\": \\\"$mailTm\\\", \\\"password\\\": \\r\\n\\\"$passwordMailTm\\\"}\"},{\"Key\":\"USE_PROFILE_PROXY\",\"Value\":\"True\"}]","comment":"Gọi api lấy token authorization"},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":22,"element_xpath":null,"output_variable_name":null,"delay":"100,100","id":"79a10bc0-3629-4817-919f-602f97ac267c","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"$excelFilePath\"},{\"Key\":\"SHEET_ID\",\"Value\":\"$sheetSaveData\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"$columnStatusMailTm\"},{\"Key\":\"ROW_INDEX\",\"Value\":\"$inputExcel[Z]\"},{\"Key\":\"DATA\",\"Value\":\"Không đăng nhập được mail TM\"}]","comment":"Không đăng nhập được mail TM"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":76,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"57509be2-7624-4ee6-9f97-691570e394b6","display_text":null,"raw_input":"[]","comment":"Dừng lại do không đọc được mail"}],"expanded":true,"id":"23c26781-6b78-47ac-bb94-38990774264b","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"!$resToken contains token\"}]","comment":"check nếu không lấy được token"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":10,"element_xpath":null,"output_variable_name":"token","delay":"200,200","id":"3cd5b276-74aa-4a3e-9e16-0562b54152c7","display_text":null,"raw_input":"[{\"Key\":\"JSON\",\"Value\":\"$resToken\"},{\"Key\":\"NODES\",\"Value\":\"token\"}]","comment":"Lấy token từ response"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":29,"element_xpath":null,"output_variable_name":"resMessages","delay":"200,500","id":"47787e98-4f99-49cc-a605-af7cc9b8e355","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"https://api.mail.tm/messages\"},{\"Key\":\"METHOD\",\"Value\":\"GET\"},{\"Key\":\"HEADER\",\"Value\":\"Authorization: Bearer $token\"},{\"Key\":\"DATA\",\"Value\":\"\"},{\"Key\":\"USE_PROFILE_PROXY\",\"Value\":\"True\"}]","comment":"Gọi API lấy danh sách message"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":10,"element_xpath":null,"output_variable_name":"arrMessages","delay":"100,100","id":"da42c707-7ad4-47a9-9d32-2871b666e176","display_text":null,"raw_input":"[{\"Key\":\"JSON\",\"Value\":\"$resMessages\"},{\"Key\":\"NODES\",\"Value\":\"hydra:member\"}]","comment":"Lấy mảng messages"},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"0,0","id":"89613e3f-b339-4075-96f4-127f1be91d8c","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"0\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"False\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Trả về code mail tm = 0"}],"expanded":false,"id":"b507f17a-d701-4497-b529-e553895e0613","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"$arrMessages = []\"}]","comment":"Check nếu chưa có message"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":68,"element_xpath":null,"output_variable_name":"idMailTm","delay":"0,0","id":"0585b0bc-f47b-4950-b27b-e15e52f2d911","display_text":null,"raw_input":"[{\"Key\":\"FILE_OR_CODE\",\"Value\":\"function findNewest(arrMail) { if (!Array.isArray(arrMail) || arrMail.length === 0) { return null; } return arrMail.reduce((newest, mail) => { const newestDate = new Date(newest.createdAt); const currentDate = new Date(mail.createdAt); return currentDate > newestDate ? mail : newest; }); } const arrMessages = $arrMessages; const arrUnseen = arrMessages.filter((temp) => { return temp.from.address == `$mailFromSource` && temp.seen == false; }); const newestMail = findNewest(arrUnseen); return (newestMail? newestMail.id : null);\"}]","comment":"Lấy id mail mới nhất của X"},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"0,0","id":"e882b46f-d2c0-4728-ad3b-d0bc1da37f9e","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"0\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"False\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Trả về code mail tm = 0 nếu không lấy được id"}],"expanded":true,"id":"0bc6d894-11d3-4d7a-ad75-451cc4f4e6a3","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"$idMailTm == null\"}]","comment":"Trả về code mail tm = 0 nếu không lấy được id"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":29,"element_xpath":null,"output_variable_name":"resMsg","delay":"200,500","id":"2e947055-bfc2-438c-89cc-c5f42cae9967","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"https://api.mail.tm/messages/$idMailTm\"},{\"Key\":\"METHOD\",\"Value\":\"GET\"},{\"Key\":\"HEADER\",\"Value\":\"Authorization: Bearer $token\"},{\"Key\":\"DATA\",\"Value\":\"\"},{\"Key\":\"USE_PROFILE_PROXY\",\"Value\":\"True\"}]","comment":"Gọi API lấy thông tin chi tiết mail"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":10,"element_xpath":null,"output_variable_name":"checkIdMsg","delay":"200,200","id":"d21ba797-03d9-4d8a-b283-42aa594e5d09","display_text":null,"raw_input":"[{\"Key\":\"JSON\",\"Value\":\"$resMsg\"},{\"Key\":\"NODES\",\"Value\":\"@id\"}]","comment":null},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"100,200","id":"4003a872-97fe-488a-b441-dffd5c44278e","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"0\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"False\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Trả về code mail tm = 0"}],"expanded":true,"id":"cde0989d-f988-4030-a1cc-48c755b2c46e","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"$checkIdMsg contains errors\"}]","comment":"Nếu có lỗi trả về code mail tm = 0"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":10,"element_xpath":null,"output_variable_name":"textMailTm","delay":"100,200","id":"bf996157-cdd2-43b6-bdc2-507be83dc0cf","display_text":null,"raw_input":"[{\"Key\":\"JSON\",\"Value\":\"$resMsg\"},{\"Key\":\"NODES\",\"Value\":\"text\"}]","comment":"lấy full text mail tm"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":68,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"100,200","id":"061b4d3e-21fa-41c0-a63b-b04d7cb71616","display_text":null,"raw_input":"[{\"Key\":\"FILE_OR_CODE\",\"Value\":\"function findSixDigitNumbers(text) { if (typeof text !== \\\"string\\\") { return []; } const regex = /\\\\b\\\\d{6}\\\\b/g; const matches = text.match(regex); return matches || []; } const textMailTm = `$textMailTm`; const arrMatches = findSixDigitNumbers(textMailTm); return arrMatches.length ? arrMatches[0] : 0;\"}]","comment":"Lấy code mail TM"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"codeMailTm","delay":"0,0","id":"6d28b90f-ce26-4e00-81c9-dec434d33e26","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"$codeMailTm\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"False\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Set code mail tm"}],"expanded":true,"id":"bace7719-19d7-420d-83a5-e71c23aeb801","display_text":null,"raw_input":"[]","comment":"Trường hợp ko lỗi vào chi tiết mail lấy code"}],"expanded":true,"id":"6e1c41e7-d0d1-42af-8aa0-65c9655e9810","display_text":null,"raw_input":"[]","comment":"Lấy code từ id mail"}],"expanded":true,"id":"956b0e5c-567c-4a40-88ab-35a49e57a786","display_text":null,"raw_input":"[]","comment":"Đã có mail về"}],"expanded":false,"id":"5c46e40c-6729-4532-9f61-3e6875a52ca1","display_text":null,"raw_input":"[]","comment":"Trường hợp lấy được token"}],"expanded":true,"id":"641bdb15-70f2-4acc-852f-298d626b4f08","display_text":null,"raw_input":null,"comment":"Main logic"},"after_quit":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[],"expanded":false,"id":"5edf89ee-3b63-4b5a-bf20-771acb27c9ad","display_text":null,"raw_input":null,"comment":"After browser closed"}}